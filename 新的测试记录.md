
(lg) root@ctyun172022236189:/nas/ganluo# python -m sglang.launch_server \
>   --model-path /nas/models/Meta-Llama-3-8B-Instruct \
>   --host 0.0.0.0 \
>   --port 30002 \
>   --base-gpu-id 1 \
>   --enable-metrics


(lg) root@ctyun172022236189:/nas/ganluo# python -m sglang.launch_server \
>   --model-path /nas/models/DeepSeek-R1-Distill-Qwen-1.5B \
>   --host 0.0.0.0 \
>   --port 30003 \
>   --base-gpu-id 2 \
>   --enable-metrics

(lg) root@ctyun172022236189:/nas/ganluo/sglang# bash /nas/ganluo/sglang/bash_start_router.sh
==========================================
SGLang Router 启动配置
==========================================
路由策略: marginal_utility_recorder
Worker节点: http://localhost:30002 http://localhost:30003
路由器地址: 0.0.0.0:29001
请求追踪: true
日志级别: INFO
==========================================

执行命令:
python /nas/ganluo/sglang/start_router.py --policy marginal_utility_recorder --host 0.0.0.0 --port 29001 --log-level INFO --workers http://localhost:30002 http://localhost:30003 --enable-tracking --max-trace-entries 100000 --trace-ttl 3600 --marginal-utility-output-dir /nas/ganluo/sglang

Port-GPU mapping saved to: /tmp/sglang_port_gpu_mapping.json
Mapping:
  Port 30002 -> cuda:0
  Port 30003 -> cuda:1

Starting router with configuration:
  Policy: marginal_utility_recorder
  Workers: ['http://localhost:30002', 'http://localhost:30003']
  Host: 0.0.0.0:29001
  Request tracking: Enabled
  Max trace entries: 100000
  Trace TTL: 3600s
  Marginal Utility Output Dir: /nas/ganluo/sglang
  Log level: INFO

Router started successfully! Press Ctrl+C to stop.
2025-07-31 12:24:53  INFO sglang_router_rs::server: src/server.rs:331: 🚧 Initializing Prometheus metrics on 127.0.0.1:29000
2025-07-31 12:24:53  INFO sglang_router_rs::server: src/server.rs:340: 🚧 Initializing router on 0.0.0.0:29001
2025-07-31 12:24:53  INFO sglang_router_rs::server: src/server.rs:341: 🚧 Router mode: Regular { worker_urls: ["http://localhost:30002", "http://localhost:30003"] }
2025-07-31 12:24:53  INFO sglang_router_rs::server: src/server.rs:342: 🚧 Policy: MarginalUtilityRecorder { window_size: 20, min_history_for_trend: 10, throughput_weight: 0.6, latency_weight: 0.4, output_dir: "/nas/ganluo/sglang", buffer_size: 1000, flush_interval_secs: 10 }
2025-07-31 12:24:53  INFO sglang_router_rs::server: src/server.rs:343: 🚧 Max payload size: 256 MB
2025-07-31 12:24:53  INFO sglang_router_rs::server: src/server.rs:353: 🚧 Service discovery disabled
2025-07-31 12:24:54  INFO sglang_router_rs::policies::marginal_utility_recorder: src/policies/marginal_utility_recorder.rs:166: Creating MarginalUtilityRecorderPolicy with output_dir: /nas/ganluo/sglang
2025-07-31 12:24:54  INFO sglang_router_rs::policies::marginal_utility: src/policies/marginal_utility.rs:70: Creating MarginalUtilityPolicy with config: MarginalUtilityConfig { window_size: 20, min_history_for_trend: 10, throughput_weight: 0.6, latency_weight: 0.4 }
2025-07-31 12:24:54  INFO sglang_router_rs::routers::router: src/routers/router.rs:185: All workers are healthy
2025-07-31 12:24:54  INFO sglang_router_rs::request_tracker: src/request_tracker.rs:65: Initializing request tracker with max_entries=100000, ttl=3600s
2025-07-31 12:24:54  INFO sglang_router_rs::server: src/server.rs:390: ✅ Serving router on 0.0.0.0:29001
2025-07-31 12:24:54  INFO sglang_router_rs::server: src/server.rs:391: ✅ Serving workers on ["http://localhost:30002", "http://localhost:30003"]


